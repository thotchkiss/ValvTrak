(function(n){function t(t,i,r){var f,u,o=t.width,s=t.width,e,h;if(h=n(t.parentNode),this.element=f=h.append("<canvas class='reflection' style='position:absolute'/>").find(":last")[0],!f.getContext&&n.browser.msie)this.element=f=h.append("<img class='reflection' style='position:absolute'/>").find(":last")[0],f.src=t.src,f.style.filter="flipv progid:DXImageTransform.Microsoft.Alpha(opacity="+r*100+", style=1, finishOpacity=0, startx=0, starty=0, finishx=0, finishy="+i/s*100+")";else{u=f.getContext("2d");try{n(f).attr({width:o,height:i});u.save();u.translate(0,s-1);u.scale(1,-1);u.drawImage(t,0,0,o,s);u.restore();u.globalCompositeOperation="destination-out";e=u.createLinearGradient(0,0,0,i);e.addColorStop(0,"rgba(255, 255, 255, "+(1-r)+")");e.addColorStop(1,"rgba(255, 255, 255, 1.0)");u.fillStyle=e;u.fillRect(0,0,o,i)}catch(c){return}}n(f).attr({alt:n(t).attr("alt"),title:n(t).attr("title")})}var i=function(i,r){this.orgWidth=i.width;this.orgHeight=i.height;this.image=i;this.reflection=null;this.alt=i.alt;this.title=i.title;this.imageOK=!1;this.options=r;this.imageOK=!0;this.options.reflHeight>0&&(this.reflection=new t(this.image,this.options.reflHeight,this.options.reflOpacity));n(this.image).css("position","absolute")},r=function(t,r,u){var f=[],o=Math.sin,s=Math.cos,e=this;this.controlTimer=0;this.stopped=!1;this.container=t;this.xRadius=u.xRadius;this.yRadius=u.yRadius;this.showFrontTextTimer=0;this.autoRotateTimer=0;u.xRadius===0&&(this.xRadius=n(t).width()/2.3);u.yRadius===0&&(this.yRadius=n(t).height()/6);this.xCentre=u.xPos;this.yCentre=u.yPos;this.frontIndex=0;this.rotation=this.destRotation=Math.PI/2;this.timeDelay=1e3/u.FPS;u.altBox!==null&&(n(u.altBox).css("display","none"),n(u.titleBox).css("display","none"));n(t).css({position:"relative",overflow:"hidden"});n(u.buttonLeft).css("display","none");n(u.buttonRight).css("display","none");u.mouseWheel&&n(t).bind("mousewheel",this,function(n,t){return n.data.rotate(t),!1});n(t).bind("mouseover click",this,function(t){var f;if(clearInterval(t.data.autoRotateTimer),f=n(t.target).attr("alt"),f!==undefined&&f!==null&&(clearTimeout(t.data.showFrontTextTimer),n(u.altBox).html(n(t.target).attr("alt")),n(u.titleBox).html(n(t.target).attr("title")),u.bringToFront&&t.type=="click")){var e=n(t.target).data("itemIndex"),o=t.data.frontIndex,i=(e-o)%r.length;Math.abs(i)>r.length/2&&(i+=i>0?-r.length:r.length);t.data.rotate(-i)}});n(t).bind("mouseout",this,function(n){var t=n.data;clearTimeout(t.showFrontTextTimer);t.showFrontTextTimer=setTimeout(function(){t.showFrontText()},1e3);t.autoRotate(1)});n(t).bind("mousedown",this,function(n){return n.data.container.focus(),!1});t.onselectstart=function(){return!1};this.innerWrapper=n(t).wrapInner('<div style="position:absolute;width:100%;height:100%;"/>').children()[0];this.showFrontText=function(){f[this.frontIndex]!==undefined&&(n(u.titleBox).html(n(f[this.frontIndex].image).attr("title")),n(u.altBox).html(n(f[this.frontIndex].image).attr("alt")))};this.go=function(){if(this.controlTimer===0){var n=this;this.controlTimer=setTimeout(function(){n.updateAll()},this.timeDelay)}};this.stop=function(){clearTimeout(this.controlTimer);this.controlTimer=0};this.rotate=function(n){this.frontIndex-=n;this.frontIndex%=f.length;this.destRotation+=Math.PI/f.length*2*n;this.showFrontText();this.go()};this.autoRotate=function(n){if(u.autoRotate!=="no"){var t=u.autoRotate==="right"?1:-1;n==0&&e.rotate(t);this.autoRotateTimer=setInterval(function(){e.rotate(t)},u.autoRotateDelay)}};this.updateAll=function(){var b=u.minScale,it=(1-b)*.5,k,l,a,v,t,i,y,d=this.destRotation-this.rotation,g=Math.abs(d),e,r,w,tt,c,h;this.rotation+=d*u.speed;g<.001&&(this.rotation=this.destRotation);var nt=f.length,rt=Math.PI/nt*2,p=this.rotation,ut=n.browser.msie;for(this.innerWrapper.style.display="none",r="px",tt=this,c=0;c<nt;c++)i=f[c],y=o(p),t=(y+1)*it+b,a=this.xCentre+(s(p)*this.xRadius-i.orgWidth*.5)*t,v=this.yCentre+y*this.yRadius*t,i.imageOK&&(h=i.image,k=h.width=i.orgWidth*t,l=h.height=i.orgHeight*t,h.style.left=a+r,h.style.top=v+r,h.style.zIndex=""+t*100>>0,i.reflection!==null&&(w=u.reflHeight*t,e=i.reflection.element.style,e.left=a+r,e.top=v+l+u.reflGap*t+r,e.width=k+r,ut?e.filter.finishy=w/l*100:e.height=w+r)),p+=rt;this.innerWrapper.style.display="block";g>=.001?this.controlTimer=setTimeout(function(){tt.updateAll()},this.timeDelay):this.stop()};this.checkImagesLoaded=function(){for(var t=0;t<r.length;t++)if(r[t].width===undefined||r[t].complete!==undefined&&!r[t].complete)return;for(t=0;t<r.length;t++)f.push(new i(r[t],u)),n(r[t]).data("itemIndex",t);clearInterval(this.tt);this.showFrontText();this.autoRotate(0);this.updateAll()};this.tt=setInterval(function(){e.checkImagesLoaded()},50)};n.fn.CloudCarousel=function(t){return this.each(function(){t=n.extend({},{reflHeight:0,reflOpacity:.5,reflGap:0,minScale:.5,xPos:0,yPos:0,xRadius:0,yRadius:0,altBox:null,titleBox:null,FPS:30,autoRotate:"no",autoRotateDelay:1500,speed:.2,mouseWheel:!1,bringToFront:!1},t);n(this).data("cloudcarousel",new r(this,n(".cloudcarousel",n(this)),t))}),this}})(jQuery);
//# sourceMappingURL=cloud-carousel.1.0.5.min.js.map
